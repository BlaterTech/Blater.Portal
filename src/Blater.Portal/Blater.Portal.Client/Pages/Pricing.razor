@page "/pricing"

@*<style>
    .mud-table-cell-custom-group {
        font-weight: 500;
    }

    .mud-table-cell-custom-group-footer {
        padding-bottom: 50px;
        text-align: right;
    }
</style>

<MudTable Hover="true" Breakpoint="Breakpoint.Sm" Height="500px" FixedHeader="true"
          GroupHeaderStyle="background-color:var(--mud-palette-background-grey)"
          Items="@_elements"
          GroupBy="@_groupDefinition"
          GroupFooterClass="mb-4"
          Dense="true"
          @ref="_tableRef">
    <ColGroup>
        <col style="width: 60px;"/>
        <col/>
        <col/>
        <col/>
        <col/>
        <col/>
    </ColGroup>
    <HeaderContent>
        <MudTh>Free Tier</MudTh>
        <MudTh>Launch</MudTh>
        <MudTh>Scale</MudTh>
        <MudTh>Enterprise</MudTh>
    </HeaderContent>
    <GroupHeaderTemplate>
        <MudTh Class="mud-table-cell-custom-group" colspan="5">@($"{context.GroupName}: {context.Key}") </MudTh>
    </GroupHeaderTemplate>
    <RowTemplate>
        <MudTd DataLabel="Free Tier">@context.A</MudTd>
        <MudTd DataLabel="Launch">@context.B</MudTd>
        <MudTd DataLabel="Scale">@context.C</MudTd>
        <MudTd DataLabel="Enterprise">@context.D</MudTd>
    </RowTemplate>
</MudTable>*@

<MudGrid Spacing="1" Class="mt-6">
    <MudItem xs="12" Style="height: 25vh">
        <MudPaper Class="pa-16 mud-width-full mud-height-full">Description</MudPaper>
    </MudItem>
    @foreach (var item in Plans)
    {
        <MudItem xs="12" md="6" lg="4" xl="4" xxl="4" Style="height: 85vh" Class="d-flex align-center">
            <BlaterCardPlan
                PlanDescription="@item.PlanDescription"
                CustomPlan="@item.CustomPlan"
                PlanInfo="@item.PlanInfo"
                PlanValue="@item.PlanValue"
                PlanButtonTitle="@item.PlanButtonTitle"
                PlanTitle="@item.PlanTitle"/>
        </MudItem>
    }
    <MudItem xs="12" Class="mb-6" Style="height: 25vh">
        <MudPaper Class="pa-16 mud-width-full mud-height-full">Go to plan table details</MudPaper>
    </MudItem>
</MudGrid>

@code {
    
    private class Plan
    {
        public required string PlanTitle { get; set; }
        public required decimal PlanValue { get; set; }
        public bool CustomPlan { get; set; } = false;
        public required string PlanButtonTitle { get; set; }
        public required string PlanDescription { get; set; }
        public required List<(bool contains, string description)> PlanInfo { get; set; }
    }
    
    private List<Plan> Plans { get; set; } = [];
    
    protected override async Task OnInitializedAsync()
    {
        await Task.Delay(1);
        Plans.Add(new Plan
        {
            PlanTitle = "Free Tier",
            PlanValue = 0,
            PlanButtonTitle = "Start for free",
            PlanDescription = "Generous always-available free tier, no credit card required.",
            PlanInfo =
            [
                new ValueTuple<bool, string>(true, "Item 1"),
                new ValueTuple<bool, string>(true, "Item 2"),
                new ValueTuple<bool, string>(true, "Item 3"),
                new ValueTuple<bool, string>(true, "Item 4"),
                new ValueTuple<bool, string>(false, "Item 5"),
                new ValueTuple<bool, string>(false, "Item 6"),
            ]
        });
        
        Plans.Add(new Plan
        {
            PlanTitle = "Launch",
            PlanValue = 19,
            PlanButtonTitle = "Get started",
            PlanDescription = "All the resources, features and support you need to launch.",
            PlanInfo =
            [
                new ValueTuple<bool, string>(true, "Item 1"),
                new ValueTuple<bool, string>(true, "Item 2"),
                new ValueTuple<bool, string>(true, "Item 3"),
                new ValueTuple<bool, string>(true, "Item 4"),
                new ValueTuple<bool, string>(true, "Item 5"),
                new ValueTuple<bool, string>(false, "Item 6"),
            ]
        });
        
        Plans.Add(new Plan
        {
            PlanTitle = "Enterprise",
            PlanValue = 0,
            CustomPlan = true,
            PlanButtonTitle = "Required trial",
            PlanDescription = "Custom plans for large datasets and database fleets.",
            PlanInfo =
            [
                new ValueTuple<bool, string>(true, "Item 1"),
                new ValueTuple<bool, string>(true, "Item 2"),
                new ValueTuple<bool, string>(true, "Item 3"),
                new ValueTuple<bool, string>(true, "Item 4"),
                new ValueTuple<bool, string>(true, "Item 5"),
                new ValueTuple<bool, string>(true, "Item 6"),
            ]
        });
    }
    
    /*private class Test
    {
        public int A { get; set; }
        public int B { get; set; }
        public int C { get; set; }
        public int D { get; set; }
        public string GroupName { get; set; } = null!;
    }
    
    private IEnumerable<Test> _elements = new List<Test>();
    
    private MudTable<Test> _tableRef;
    
    private TableGroupDefinition<Test> _groupDefinition = new()
    {
        GroupName = "INCLUDED",
        Indentation = false,
        Expandable = false,
        Selector = (e) => e.GroupName,
        InnerGroup = new TableGroupDefinition<Test>
        {
            GroupName = "ASDASDASDAS",
            Selector = x => $"ASDASDASDAS_{x.GroupName}",
            Expandable = true,
            Indentation = true,
            IsInitiallyExpanded = false
        }
    };
    
    protected override void OnInitialized()
    {
        var asd = new List<Test>();
        for (var i = 0; i < 101; i++)
        {
            asd.Add(new Test
            {
                A = i,
                B = i,
                C = i,
                D = i,
                GroupName = $"GroupName_{i}"
            });
        }
    
        _elements = asd;
    }*/
    
}